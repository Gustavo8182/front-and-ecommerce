<div class="container mt-5 mb-5 fade-in" *ngIf="!isLoading && product">
  <div class="row g-5">

    <div class="col-md-6">
      <div class="card border-0 shadow-sm overflow-hidden">
        <img [src]="currentImage" class="img-fluid w-100" style="max-height: 500px; object-fit: contain; background-color: #f8f9fa;">
      </div>

      <div class="d-flex gap-2 mt-3 overflow-auto" *ngIf="product.images.length > 1">
        <img *ngFor="let img of product.images"
             [src]="img.imageUrl"
             (click)="currentImage = img.imageUrl"
             class="rounded border cursor-pointer hover-shadow"
             style="width: 70px; height: 70px; object-fit: cover;">
      </div>
    </div>

    <div class="col-md-6">
      <small class="text-uppercase text-muted fw-bold">{{ product.category.name }}</small>
      <h1 class="fw-bold mt-2">{{ product.name }}</h1>

      <div class="d-flex align-items-center gap-2 mb-3">
        <span class="badge bg-success" *ngIf="product.active">Disponível</span>
        <span class="text-muted" *ngIf="product.store">Vendido por: <strong>{{ product.store.name }}</strong></span>
      </div>

      <h2 class="text-primary fw-bold mb-4">
        R$ {{ (selectedVariation?.price || 0) | number:'1.2-2' }}
      </h2>

      <div class="mb-4">
        <label class="form-label fw-bold d-block mb-2">Escolha a Variação:</label>
        <div class="d-flex flex-wrap gap-2">
          <button *ngFor="let v of product.variations"
                  class="btn btn-variation"
                  [class.active]="selectedVariation?.id === v.id"
                  [disabled]="v.quantityStock <= 0"
                  (click)="selectVariation(v)">
            {{ v.name }}
            <span *ngIf="v.quantityStock <= 0" class="badge bg-secondary ms-1">Esgotado</span>
          </button>
        </div>
      </div>

      <div class="d-grid gap-2">
        <button class="btn btn-primary btn-lg py-3"
                [disabled]="!selectedVariation || selectedVariation.quantityStock <= 0"
                (click)="addToCart()">
          <i class="bi bi-cart-plus me-2"></i> Adicionar ao Carrinho
        </button>
      </div>

      <div class="mt-5">
        <h5 class="fw-bold border-bottom pb-2">Descrição do Produto</h5>
        <p class="text-muted mt-3" style="white-space: pre-line;">
          {{ product.description }}
        </p>
      </div>
    </div>
  </div>
</div>

<div *ngIf="isLoading" class="text-center py-5 mt-5">
  <div class="spinner-border text-primary" role="status"></div>
  <p class="mt-3 text-muted">Carregando detalhes...</p>
</div>
