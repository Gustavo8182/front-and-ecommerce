<div class="container mt-4">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Resultados para: <span class="text-primary">"{{ searchTerm }}"</span></h2>
    <a routerLink="/" class="btn btn-outline-secondary">Voltar para Home</a>
  </div>

  <div *ngIf="products.length === 0" class="alert alert-warning">
    Nenhum produto encontrado para essa pesquisa.
  </div>

  <div class="row">
    <div class="col-md-4 mb-4" *ngFor="let product of products">
      <div class="card h-100 shadow-sm">

        <div class="card-header bg-transparent border-0 text-center py-4 position-relative"
             [routerLink]="['/product', product.id]"
             style="cursor: pointer;">

          <img *ngIf="product.images && product.images.length > 0"
               [src]="getMainImage(product)"
               [alt]="product.name"
               class="img-fluid"
               style="max-height: 200px; object-fit: contain;">

          <div *ngIf="!product.images || product.images.length === 0" class="py-5 bg-light rounded">
             <i class="bi bi-box-seam display-1 text-secondary"></i>
          </div>
        </div>

        <div class="card-body d-flex flex-column">
          <h5 class="card-title text-primary"
              [routerLink]="['/product', product.id]"
              style="cursor: pointer;">
              {{ product.name }}
          </h5>

          <small class="text-muted mb-2">{{ product.brand }}</small>

          <p class="card-text text-muted small flex-grow-1">
            {{ product.description | slice:0:80 }}<span *ngIf="product.description.length > 80">...</span>
          </p>

          <div class="mt-2">
            <small class="text-muted" style="font-size: 0.8rem">A partir de</small>
            <h4 class="text-success m-0">
              {{ getDisplayPrice(product) | currency:'BRL' }}
            </h4>
          </div>
        </div>

        <div class="card-footer bg-white border-0 d-flex gap-2 pb-3">

          <a [routerLink]="['/product', product.id]" class="btn btn-outline-secondary flex-fill">
            <i class="bi bi-eye"></i> Detalhes
          </a>

          <a [routerLink]="['/product', product.id]" class="btn btn-primary flex-fill">
            <i class="bi bi-cart-plus"></i> Ver Opções
          </a>

        </div>

      </div>
    </div>
  </div>
</div>
