<div class="container mt-4 mb-5 fade-in">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="fw-bold mb-1">Gerir Pedidos</h2>
      <p class="text-muted mb-0">Pedidos feitos na sua loja que precisam de atenção.</p>
    </div>
    <button class="btn btn-outline-primary" (click)="loadOrders()">
      <i class="bi bi-arrow-clockwise me-2"></i>Atualizar
    </button>
  </div>

  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-2 text-muted">A carregar vendas...</p>
  </div>

  <div *ngIf="!isLoading && orders.length === 0" class="text-center py-5 bg-white rounded shadow-sm border">
    <i class="bi bi-inbox display-1 text-muted opacity-25"></i>
    <h4 class="mt-3">Nenhuma venda ainda</h4>
    <p class="text-muted">Partilhe os seus produtos para começar a vender!</p>
  </div>

  <div *ngIf="!isLoading && orders.length > 0" class="card border-0 shadow-sm">
    <div class="table-responsive">
      <table class="table align-middle mb-0 table-hover">
        <thead class="bg-light">
          <tr>
            <th class="ps-4">Produto</th>
            <th>Data</th>
            <th>Total</th>
            <th>Status</th>
            <th class="text-end pe-4">Ações</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let order of orders">
            <td class="ps-4">
              <div class="d-flex align-items-center" *ngIf="order.items.length > 0">
                <img [src]="order.items[0].imageUrl || 'assets/placeholder.png'"
                     class="rounded border me-3"
                     style="width: 48px; height: 48px; object-fit: cover;">
                <div>
                  <div class="fw-bold text-dark">{{ order.items[0].productName }}</div>
                  <small class="text-muted" *ngIf="order.items.length > 1">
                    + {{ order.items.length - 1 }} outros itens
                  </small>
                  <small class="text-muted" *ngIf="order.items.length === 1">
                    {{ order.items[0].variationName }}
                  </small>
                </div>
              </div>
            </td>

            <td class="text-muted">{{ order.creationDate | date:'dd/MM/yyyy HH:mm' }}</td>

            <td class="fw-bold text-success">R$ {{ order.total | number:'1.2-2' }}</td>

            <td>
              <span class="badge rounded-pill" [ngClass]="getStatusBadge(order.status)">
                {{ translateStatus(order.status) }}
              </span>
            </td>

            <td class="text-end pe-4">
              <div class="dropdown">
                <button class="btn btn-sm btn-light border dropdown-toggle" type="button" data-bs-toggle="dropdown">
                  Gerir
                </button>
                <ul class="dropdown-menu dropdown-menu-end shadow">
                  <li><a class="dropdown-item" href="#"><i class="bi bi-eye me-2"></i>Ver Detalhes</a></li>
                  <li><hr class="dropdown-divider"></li>
                  <li><a class="dropdown-item text-primary fw-bold" href="#"><i class="bi bi-box-seam me-2"></i>Confirmar Envio</a></li>
                  <li><a class="dropdown-item text-danger" href="#"><i class="bi bi-x-circle me-2"></i>Cancelar Pedido</a></li>
                </ul>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="card-footer bg-white py-3 d-flex justify-content-end">
      <small class="text-muted">Total: {{ totalElements }} vendas</small>
    </div>
  </div>
</div>
