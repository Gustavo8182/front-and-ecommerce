<div class="container mt-5 mb-5">

  <div class="row mb-5 align-items-center">
    <div class="col-md-6">
      <h2 class="fw-bold text-dark mb-0">Nossos Produtos</h2>
      <p class="text-muted">As melhores ofertas para você</p>
    </div>
    <div class="col-md-6">
      <div class="input-group shadow-sm">
        <input type="text"
               class="form-control border-0 bg-light"
               placeholder="O que você procura hoje?"
               [(ngModel)]="searchTerm"
               (keyup)="handleKeyUp($event)"
               style="padding: 12px 20px;">
        <button class="btn btn-primary px-4" (click)="onSearch()">
          <i class="bi bi-search"></i>
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="products.length === 0" class="text-center py-5">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-2 text-muted">Carregando catálogo...</p>
  </div>

  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4" *ngIf="products.length > 0">

    <div class="col" *ngFor="let product of products">

      <div class="card h-100 shadow-sm product-card border-0">

        <div class="img-wrapper" [routerLink]="['/product', product.id]">

          <img *ngIf="product.images && product.images.length > 0"
               [src]="getMainImage(product)"
               [alt]="product.name">

          <div *ngIf="!product.images || product.images.length === 0" class="no-photo">
            <i class="bi bi-image display-4 mb-2"></i>
            <small>Sem imagem</small>
          </div>
        </div>

        <div class="card-body">
          <div class="mb-2">
            <span class="badge bg-light text-secondary border category-badge">
              {{ product.category.name || 'Geral' }}
            </span>
          </div>

          <h5 class="card-title text-dark fw-bold text-truncate"
              [title]="product.name"
              [routerLink]="['/product', product.id]">
            {{ product.name }}
          </h5>

          <div class="mt-auto pt-3">
            <small class="text-muted d-block" style="font-size: 0.8rem">A partir de</small>

            <h4 class="price-tag mb-0">
              <span *ngIf="getDisplayPrice(product) > 0">
                {{ getDisplayPrice(product) | currency:'BRL' }}
              </span>
              <span *ngIf="getDisplayPrice(product) === 0" class="text-muted fs-6">
                Ver Opções
              </span>
            </h4>
          </div>

          <a [routerLink]="['/product', product.id]"
             class="btn btn-primary w-100 mt-3 fw-bold shadow-sm">
             Ver Detalhes
          </a>

        </div>
      </div>
    </div>

  </div>

  <nav *ngIf="totalPages > 1" class="d-flex justify-content-center mt-5">
    <ul class="pagination">
      <li class="page-item" [class.disabled]="currentPage === 0">
        <button class="page-link border-0 shadow-sm mx-1 rounded-circle"
                style="width: 40px; height: 40px;"
                (click)="changePage(currentPage - 1)">
          <i class="bi bi-chevron-left"></i>
        </button>
      </li>

      <li class="page-item disabled">
        <span class="page-link border-0 bg-transparent fw-bold text-muted mx-2">
          {{ currentPage + 1 }} / {{ totalPages }}
        </span>
      </li>

      <li class="page-item" [class.disabled]="currentPage === totalPages - 1">
        <button class="page-link border-0 shadow-sm mx-1 rounded-circle"
                style="width: 40px; height: 40px;"
                (click)="changePage(currentPage + 1)">
          <i class="bi bi-chevron-right"></i>
        </button>
      </li>
    </ul>
  </nav>

</div>
